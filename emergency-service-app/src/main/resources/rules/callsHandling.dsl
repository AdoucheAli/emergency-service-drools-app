[condition][]There is an Emergency=$emergency: Emergency()
[consequence][]Start Emergency Process=java.text.DateFormat df = SimpleDateFormat.getInstance().getDateTimeInstance(SimpleDateFormat.SHORT, SimpleDateFormat.SHORT); Map<String, Object> parameters = new HashMap<String, Object>(); parameters.put("emergency", $emergency ); parameters.put("call.id", $emergency.getCall().getId()); parameters.put("call.timestamp", df.format($emergency.getCall().getDate()));parameters.put("call.phoneNumber", $emergency.getCall().getPhoneNumber());ProcessInstance pI = kcontext.getKnowledgeRuntime().startProcess("com.wordpress.salaboy.bpmn2.EmergencyService", parameters); $emergency.getCall().setProcessId(pI.getId());update($emergency);insert(pI);
[consequence][]Notify about the incoming Call=callManager.incomingCall($emergency.getCall());